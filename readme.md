# cmi-viaduc-web-frontend

- [cmi-viaduc](https://github.com/SwissFederalArchives/cmi-viaduc)
  - [cmi-viaduc-web-core](https://github.com/SwissFederalArchives/cmi-viaduc-web-core)
  - **[cmi-viaduc-web-frontend](https://github.com/SwissFederalArchives/cmi-viaduc-web-frontend)** :triangular_flag_on_post:
  - [cmi-viaduc-web-management](https://github.com/SwissFederalArchives/cmi-viaduc-web-management)
  - [cmi-viaduc-backend](https://github.com/SwissFederalArchives/cmi-viaduc-backend)

# Context

The [Viaduc](https://github.com/SwissFederalArchives/cmi-viaduc) project includes 4 code repositories. The present repository `cmi-viaduc-web-frontend` provides the source code of an Angular application that constitutes the public part of the online access.
Together with the internal management application ([cmi-viaduc-web-management](https://github.com/SwissFederalArchives/cmi-viaduc-web-management)), it uses a common code library ([cmi-viaduc-web-core](https://github.com/SwissFederalArchives/cmi-viaduc-web-core)). The front-end applications are hosted in an `ASP.NET` container (see backend repository [cmi-viaduc-backend](https://github.com/SwissFederalArchives/cmi-viaduc-backend)) and communicate with the system via web API.

![The Big-Picture](docs/imgs/context.svg)

> Note: A general description of the repositories can be found in the repository [cmi-viaduc](https://github.com/SwissFederalArchives/cmi-viaduc).

# Architecture and components

This is an Angular CLI project in the form of an application.
The files generated by the build process are stored in the `client` folder within the `CMI.Viaduc.Web.Frontend` WebAPI project.

The application contains the GUI for the main application, the public area of the online access.

## Modules

- `app`
  - Components that are directly accessed by routing (1st level route) (`pages`)
- `client`
  - Components and services used within the pages, e.g. for searching, ordering, navigation, etc.

# First steps

## Preparations

- [Node.js download](https://nodejs.org/en/), LTS version
- Make sure that old angular/cli versions are uninstalled
  - `npm uninstall angular-cli`
  - `npm uninstall @angular/cli`
  - `npm cache clean --force`
- Install Angular CLI
  - `npm install -g @angular/cli`
- Clone repository [cmi-viaduc-web-core](https://github.com/SwissFederalArchives/cmi-viaduc-web-core) to a directory (e.g. C:\Viaduc)
- Clone repository `cmi-viaduc-web-frontend` into the same root directory (e.g. C:\Viaduc)
- Change to the `cmi-viaduc-web-core` directory with a command line
  - Run: `npm i` to install the dependencies
  - Run: `npm run build` to build the library

## Install

- Use the command line to change to the `cmi-viaduc-web-frontend` directory
  - Run: `npm run link` to link `cmi-viaduc-web-core` as a component
  - Run: `npm i` to install the dependencies
  - Run: `npm run build` build the project to a `dist` folder inside `cmi-viaduc-web-frontend`.

# Customization

## General

- Pay attention to TSLint
- Move business logic into services

## Run tests

- Run tests once `ng test --watch=false`
- Run tests as watcher `ng test`

## Execute

- Variant a.)
  - build using `npm run build` and start ASP.NET (`CMI.Viaduc.Web.Frontend`)
- Variant b.)
  - Start running build (file-watch) using `npm run start` and ASP.NET (`CMI.Viaduc.Web.Frontend`)

# Authors

- [CM Informatik AG](https://cmiag.ch)
- [Evelix GmbH](https://evelix.ch)

# License

GNU Affero General Public License (AGPLv3), see [LICENSE](LICENSE.TXT)

# Contribute

This repository is a copy which is updated regularly - therefore contributions via pull requests are not possible. However, independent copies (forks) are possible under consideration of the AGPLV3 license.

# Contact

- For general questions (and technical support), please contact the Swiss Federal Archives by e-mail at bundesarchiv@bar.admin.ch.
- Technical questions or problems concerning the source code can be posted here on GitHub via the "Issues" interface.
